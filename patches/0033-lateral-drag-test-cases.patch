From d104ff3d81eb1139d270eed9d7c6e81fd8a94c83 Mon Sep 17 00:00:00 2001
From: dpath2o <dpath2o@mac.com>
Date: Mon, 2 Feb 2026 09:18:30 +1100
Subject: [PATCH 33/34] lateral drag test cases

---
 cicecore/cicedyn/dynamics/ice_dyn_evp.F90 | 2 +-
 cicecore/cicedyn/general/ice_init.F90     | 4 ++--
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/cicecore/cicedyn/dynamics/ice_dyn_evp.F90 b/cicecore/cicedyn/dynamics/ice_dyn_evp.F90
index 9a35e0d..2c66b6c 100644
--- a/cicecore/cicedyn/dynamics/ice_dyn_evp.F90
+++ b/cicecore/cicedyn/dynamics/ice_dyn_evp.F90
@@ -1004,7 +1004,7 @@ subroutine evp (dt)
             case ('sum')
                static_switch   = c1
                quad_switch     = c1
-               linear_switch   = merge(c1, c0, C_L > 0.0d0)   ! your requested behavior
+               linear_switch   = merge(c1, c0, C_L > 0.0d0) 
             case ('sum_quad_cap')
                static_switch   = c1
                quad_cap_switch = c1
diff --git a/cicecore/cicedyn/general/ice_init.F90 b/cicecore/cicedyn/general/ice_init.F90
index cc9ec55..5b86574 100644
--- a/cicecore/cicedyn/general/ice_init.F90
+++ b/cicecore/cicedyn/general/ice_init.F90
@@ -424,10 +424,10 @@ subroutine input_data
       ! DYNAMICS
       boundary_condition    = 'no_slip'       ! 'no_slip' (Dirchlet) or 'free_slip' (Neumann); boundary conditions
       lateral_drag          = .false.         ! if true, enable lateral drag parameterisation for landfast ice
-      form_func             = 'static'        ! 'static', 'quad', 'sum', 'linear'
+      form_func             = 'static'        ! 'static', 'quad', 'sum', 'linear', 'quad_cap', 'sum_quad_cap'
       Cs                    = 1.0e-4_dbl_kind ! see Liu et al. (2022) section 3.3
       Cq                    = 1.0_dbl_kind    ! see Liu et al. (2022) section 3.3
-      u_cap                 = 0.0_dbl_kind    
+      u_cap                 = 0.0_dbl_kind    ! 
       C_L                   = 0.0_dbl_kind    ! linear form function scaling coeficient (unitless)
       u0                    = 5.0e-4_dbl_kind ! see Lemieux et al. (2015) section 6
       kdyn                  = 1               ! type of dynamics (-1, 0 = off, 1 = evp, 2 = eap, 3 = vp)
-- 
2.43.7

